<Window x:Class="AccesosLauncher.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Accesos" Width="1100" Height="750"
        Loaded="Window_Loaded"
        Closing="Window_Closing"
        WindowStartupLocation="CenterScreen">
    <Window.Resources>
        <CollectionViewSource x:Key="GroupedItems" Source="{Binding Items}">
            <CollectionViewSource.GroupDescriptions>
                <PropertyGroupDescription PropertyName="RelativeDirectory"/>
            </CollectionViewSource.GroupDescriptions>
        </CollectionViewSource>
        <Style TargetType="ScrollViewer">
            <Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
            <Setter Property="HorizontalScrollBarVisibility" Value="Disabled"/>
        </Style>
    </Window.Resources>

    <DockPanel>
        <StackPanel Orientation="Horizontal" DockPanel.Dock="Top" Margin="10">
            <TextBlock Text="Buscar:" VerticalAlignment="Center" Margin="0,0,8,0"/>
            <TextBox x:Name="SearchBox" Width="380"
                     Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                     VerticalAlignment="Center"/>
            <TextBlock Text="{Binding ResultCountText}" Margin="12,0,0,0" VerticalAlignment="Center"
                       Foreground="Gray"/>
        </StackPanel>

        <ListView ItemsSource="{Binding Source={StaticResource GroupedItems}}" x:Name="ListViewItems"
                  ScrollViewer.CanContentScroll="True">
            <ListView.GroupStyle>
                <GroupStyle>
                    <GroupStyle.HeaderTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Name}" FontWeight="Bold" FontSize="16" Margin="0,12,0,6"/>
                        </DataTemplate>
                    </GroupStyle.HeaderTemplate>
                    <GroupStyle.Panel>
                        <ItemsPanelTemplate>
                            <WrapPanel IsItemsHost="True"/>
                        </ItemsPanelTemplate>
                    </GroupStyle.Panel>
                </GroupStyle>
            </ListView.GroupStyle>

            <ListView.ItemTemplate>
                <DataTemplate>
                    <Button Margin="6" Padding="8"
                            Tag="{Binding}"
                            Click="ItemButton_Click"
                            ToolTip="{Binding FullPath}"
                            MinWidth="160">
                        <StackPanel Orientation="Vertical" HorizontalAlignment="Center">
                            <Image Source="{Binding Icon}" Width="48" Height="48"
                                   SnapsToDevicePixels="True"/>
                            <TextBlock Text="{Binding Name}" TextAlignment="Center"
                                       TextTrimming="CharacterEllipsis"
                                       MaxWidth="220"
                                       TextWrapping="Wrap" Margin="4,6,4,0"/>
                        </StackPanel>
                    </Button>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>
    </DockPanel>
</Window>
